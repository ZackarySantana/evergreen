#######################################
#              Functions              #
#######################################
functions:
  get-project:
    - command: git.get_project
      type: setup
      params:
        directory: evergreen
        token: ${github_token}
        shallow_clone: true
#######################################
#                Tasks                #
#######################################

pre_error_fails_task: true

pre: 
  - command: shell.exec
    params:
      shell: bash
      script: |
        curl -d '{"status":"failed", "type":"setup", "desc":"this should be set", "should_continue": false}' -H "Content-Type: application/json" -X POST localhost:2285/task_status

tasks:
  - name: my-task
    commands:
      - func: get-project
      - command: shell.exec
        params:
          script: |
            echo "I finished getting the project"

#######################################
#            Buildvariants            #
#######################################
buildvariants:
  - name: rhel62
    display_name: rhel62
    run_on:
      - rhel62
    tasks:
      - name: my-task
  - name: rhel70
    display_name: rhel70
    run_on:
      - rhel70
    tasks:
      - name: my-task
  - name: rhel71-power8
    display_name: rhel71-power8
    run_on:
      - rhel71-power8
    tasks:
      - name: my-task
  - name: rhel72-zseries
    display_name: rhel72-zseries
    run_on:
      - rhel72-zseries
    tasks:
      - name: my-task
  - name: windows-64-vs2015
    display_name: windows-64-vs2015
    run_on:
      - windows-64-vs2015
    tasks:
      - name: my-task
  - name: macos-1014
    display_name: macos-1014
    run_on:
      - macos-1014
    tasks:
      - name: my-task
  - name: linux-64-amzn
    display_name: linux-64-amzn
    run_on:
      - linux-64-amzn
    tasks:
      - name: my-task
  - name: archlinux
    display_name: archlinux
    run_on:
      - archlinux
    tasks:
      - name: my-task
  - name: archlinux-packer
    display_name: archlinux-packer
    run_on:
      - archlinux-packer
    tasks:
      - name: my-task
  - name: ubuntu1404
    display_name: ubuntu1404
    run_on:
      - ubuntu1404
    tasks:
      - name: my-task
  - name: ubuntu2204
    display_name: ubuntu2204
    run_on:
      - ubuntu2204-large
      - ubuntu2204-small
    tasks:
      - name: my-task
  - name: ubuntu1604
    display_name: ubuntu1604
    run_on:
      - ubuntu1604
    tasks:
      - name: my-task
  - name: debian81
    display_name: debian81
    run_on:
      - debian81
    tasks:
      - name: my-task
  - name: debian92
    display_name: debian92
    run_on:
      - debian92
    tasks:
      - name: my-task
  - name: suse12-sp5-large
    display_name: suse12-sp5-large
    run_on:
      - suse12-sp5-large
    tasks:
      - name: my-task
  - name: amazon1-2018
    display_name: amazon1-2018
    run_on:
      - amazon1-2018
    tasks:
      - name: my-task